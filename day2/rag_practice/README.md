# RAG (Retrieval-Augmented Generation) 시스템

LangChain을 활용한 RAG 시스템으로 다음 워크플로우를 구현합니다:

## 워크플로우
1. **사용자 질의 입력**
2. **관련 문서 검색** - 벡터 유사도 검색
3. **관련성 확인** - LLM을 통한 관련성 점수 평가
4. **답변 생성** - 컨텍스트 기반 LLM 답변 생성
5. **할루시네이션 검증** - 생성된 답변의 정확성 검증 (최대 5회 재시도)
6. **최종 답변 제공** - 검증된 답변 또는 실패 메시지

## 설치 방법

```bash
pip install -r requirements.txt
```

## 환경 설정

OpenAI API 키를 환경변수로 설정:

```bash
export OPENAI_API_KEY="your-api-key-here"
```

## 실행 방법

```bash
python src/main.py
```

## 주요 기능

### 1. 문서 검색 및 관련성 확인
- FAISS 벡터 저장소를 통한 의미적 유사도 검색
- LLM 기반 관련성 점수 평가 (0-10점)
- 설정 가능한 관련성 임계값 (기본값: 7점)

### 2. 할루시네이션 방지
- 생성된 답변과 제공된 컨텍스트 간의 일치성 검증
- 최대 5회까지 답변 재생성 시도
- 컨텍스트에 없는 정보 포함 시 재시도

### 3. 안전한 답변 생성
- 컨텍스트 기반으로만 답변 생성
- 불충분한 정보 시 명시적 안내
- 오류 상황에 대한 적절한 처리

## 사용 예시

시스템 실행 후 다음과 같은 질문들을 시도해볼 수 있습니다:

- "인공지능의 주요 응용 분야는 무엇인가요?"
- "머신러닝의 유형에 대해 설명해주세요"
- "지도학습과 비지도학습의 차이점은 무엇인가요?"

## 시스템 구성 요소

- **RAGSystem**: 메인 RAG 시스템 클래스
- **문서 로더**: 텍스트 파일 로드 및 처리
- **벡터 저장소**: FAISS 기반 임베딩 저장
- **관련성 평가기**: LLM 기반 문서 관련성 평가
- **답변 생성기**: 컨텍스트 기반 답변 생성
- **할루시네이션 검증기**: 답변 정확성 검증

## 사용자 정의 설정

`RAGSystem` 클래스에서 다음 설정을 조정할 수 있습니다:

- `relevance_threshold`: 관련성 임계값 (기본값: 0.7)
- `max_hallucination_retries`: 최대 재시도 횟수 (기본값: 5)
- 청크 크기 및 겹침 설정
- 검색할 문서 개수 (k값)